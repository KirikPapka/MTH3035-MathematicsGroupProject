      subroutine init_theta(zn, th_n )
     
      IMPLICIT none
      INCLUDE 'params.inc'
      ! Inputs
      REAL,  INTENT(IN), DIMENSION(kkp) :: zn
      INTEGER :: k, i
      
      real :: z_lev(89)
      real :: theta_n(89)
     
      ! Outputs a linear piece-wise profile of Theta or qv
      REAL, INTENT(OUT), DIMENSION(kkp) :: th_n
      
     z_lev = (/0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0,&
      100.0, 150.0, 200.0, 250.0, 300.0, 350.0, 400.0, 450.0, 500.0, 550.0,&
      600.0, 650.0, 700.0, 750.0, 800.0, 850.0, 900.0, 950.0, 1000.0, 1050.0,&
      1100.0, 1150.0, 1200.0, 1250.0, 1300.0, 1350.0, 1400.0, 1450.0, 1500.0, 1550.0,&
      1600.0, 1650.0, 1700.0, 1750.0, 1800.0, 1850.0, 1900.0, 1950.0, 2000.0, 2050.0,&
      2100.0, 2150.0, 2200.0, 2250.0, 2300.0, 2350.0, 2400.0, 2450.0, 2500.0, 2550.0,&
      2600.0, 2650.0, 2700.0, 2750.0, 2800.0, 2850.0, 2900.0, 2950.0, 3000.0, 3050.0,&
      3100.0, 3150.0, 3200.0, 3250.0, 3300.0, 3350.0, 3400.0, 3450.0, 3500.0, 3550.0,&
      3600.0, 3650.0, 3700.0, 3750.0, 3800.0, 3850.0, 3900.0, 3950.0, 4000.0/)

      theta_n = (/270.115, 272.589, 273.486, 274.270, 274.905, 275.258,&
       275.822, 276.056, 276.157, 276.250, 276.352, 276.837,&
       277.515, 278.012, 278.393, 278.577, 278.671, 278.759,&
       278.777, 278.833, 279.022, 281.448, 282.600, 283.452,&
       283.753, 284.764, 285.470, 285.862, 286.365, 286.869,&
       287.263, 287.671, 288.280, 288.577, 288.878, 289.381,&
       289.584, 290.085, 290.501, 291.006, 291.415, 291.509,&
       292.131, 292.635, 293.057, 293.251, 293.766, 294.190,&
       294.383, 294.697, 295.003, 295.313, 295.723, 296.136,&
       296.553, 296.963, 297.064, 297.270, 297.371, 297.794,&
       297.994, 298.304, 298.399, 298.498, 298.705, 298.903,&
       298.998, 298.986, 299.193, 299.297, 299.391, 299.607,&
       299.818, 300.024, 300.118, 300.214, 300.425, 300.528,&
       300.741, 301.174, 301.494, 301.827, 302.036, 302.585,&
       303.143, 303.469, 303.794, 304.241, 304.692/)

      do k=1, kkp
       do i=1,size(z_lev)-1
         if (z_lev(i) <= zn(k) .and. zn(k) < z_lev(i+1)) then
          th_n(k) = theta_n(i)+(theta_n(i+1)-theta_n(i)) * (zn(k)-z_lev(i))/(z_lev(i+1)-z_lev(i))
         end if
       end do
            
       if (zn(k) >=z_lev(size(z_lev))) then
        th_n(k) = theta_n(size(z_lev))
       end if
       
      end do

      end
  
